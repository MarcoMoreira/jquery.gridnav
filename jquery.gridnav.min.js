(function(e){jQuery.fn.reverse=Array.prototype.reverse;var t={setup:function(r,i,s){r.css("position","relative");t.saveInitialPosition(i);i.each(function(t){var n=e(this);n.css({position:"absolute",left:n.data("left"),top:n.data("top")})});var o=Math.floor(r.width()/i.width()),u=o*s.rows,a=Math.ceil(i.length/o);var f={};f.currentRow=1;f.totalRows=a;f.rowCount=o;f.shownItems=u;f.rowsForPage=s.rows;r.data("config",f);r.children(":gt("+(u-1)+")").hide();i.each(function(t){var n=e(this),r=Math.ceil((t+1)/o);n.addClass("tj_row_"+r)});if($d_nav.length>0){var l=[];for(var c=0;c<t.get_pages(r);c++)l.push(e("<li />"));$d_nav.html(l).end().find("li:first-child").addClass("active");delete l}n.setup(r,i,s)},saveInitialPosition:function(t){t.each(function(t){var n=e(this);n.data({left:n.position().left+"px",top:n.position().top+"px"})})},get_page:function(e){var t=e.data("config");return Math.ceil(t.currentRow/t.rowsForPage)},get_pages:function(e){var t=e.data("config");return Math.ceil(t.totalRows/t.rowsForPage)},has_next:function(e){return t.get_page(e)<t.get_pages(e)?true:false},has_prev:function(e){return t.get_page(e)>1?true:false}},n={setup:function(e,t,r){n[r.type.mode].setup(e,t,r)},def:{setup:function(t,n,r){var i=t.data("config");n.each(function(t){var s=e(this),o=Math.ceil((t+1)/i.rowCount),u,a=o%r.rows;if(a===1){u="0px"}else if(a===0){u=(r.rows-1)*n.height()+"px"}else{u=(a-1)*n.height()+"px"}s.css({top:u})})},pagination:function(e,t,n){var r=e.data("config");if(t===1&&r.currentRow+n.rows>r.totalRows||t===-1&&r.currentRow-n.rows<=0){e.data("anim",false);return false}var i=[],s=[];for(var o=0;o<n.rows;++o){i.push(".tj_row_"+(r.currentRow+o));s.push(t===1?".tj_row_"+(r.currentRow+n.rows+o):".tj_row_"+(r.currentRow-1-o))}i=i.join(","),s=s.join(",");e.children(i).hide();e.children(s).show();t===1?r.currentRow+=n.rows:r.currentRow-=n.rows;e.data("anim",false);e.data("config",r)}},fade:{setup:function(e,t,r){n["def"].setup(e,t,r)},pagination:function(e,t,n){var r=e.data("config");if(t===1&&r.currentRow+n.rows>r.totalRows||t===-1&&r.currentRow-n.rows<=0){e.data("anim",false);return false}var i=[],s=[];for(var o=0;o<n.rows;++o){i.push(".tj_row_"+(r.currentRow+o));s.push(t===1?".tj_row_"+(r.currentRow+n.rows+o):".tj_row_"+(r.currentRow-1-o))}s=s.join(",");e.children(i).fadeOut(n.type.speed,n.type.easing);var u=e.children(s),a=u.length,f=0;u.fadeIn(n.type.speed,n.type.easing,function(){++f;if(f===a){e.data("anim",false)}});t===1?r.currentRow+=n.rows:r.currentRow-=n.rows;e.data("config",r)}},seqfade:{setup:function(e,t,r){n["def"].setup(e,t,r)},pagination:function(t,n,r){var i=t.data("config");if(n===1&&i.currentRow+r.rows>i.totalRows||n===-1&&i.currentRow-r.rows<=0){t.data("anim",false);return false}var s=[],o=[];for(var u=0;u<r.rows;++u){s.push(".tj_row_"+(i.currentRow+u));o.push(n===1?".tj_row_"+(i.currentRow+r.rows+u):".tj_row_"+(i.currentRow-1-u))}s=s.join(","),o=o.join(",");var a=r.type.factor;var f;n===1?f=t.children(s):f=t.children(s).reverse();f.each(function(t){var n=e(this);setTimeout(function(){n.fadeOut(r.type.speed,r.type.easing)},a+t*a)});var l;n===1?l=t.children(o):l=t.children(o).reverse();var c=l.length,h=0;l.each(function(n){var i=e(this);setTimeout(function(){i.fadeIn(r.type.speed,r.type.easing,function(){++h;if(h===c){t.data("anim",false)}})},a*2+n*a)});n===1?i.currentRow+=r.rows:i.currentRow-=r.rows;t.data("config",i)}},updown:{setup:function(t,n,r){var i=t.data("config");t.children(":gt("+(i.shownItems-1)+")").css("opacity",0);n.each(function(t){var s=e(this),o=Math.ceil((t+1)/i.rowCount),u=s.position().top,a=o%r.rows;if(o>r.rows){u=r.rows*n.height()}s.css({top:u+"px"})})},pagination:function(t,n,r){var i=t.data("config");if(n===1&&i.currentRow+r.rows>i.totalRows||n===-1&&i.currentRow-1<=0){t.data("anim",false);return false}var s=[];for(var o=0;o<=r.rows;++o){s.push(n===1?".tj_row_"+(i.currentRow+o):".tj_row_"+(i.currentRow+(o-1)))}s=s.join(",");var u;n===1?u=t.children(s):u=t.children(s).reverse();var a=u.length,f=0;u.each(function(s){var o=e(this),u=o.attr("class"),l={},c=i.currentRow;if(n===1){if(u==="tj_row_"+c){l.opacity=0}else if(u==="tj_row_"+(c+r.rows)){l.opacity=1}}else{if(u==="tj_row_"+(c-1)){l.opacity=1}else if(u==="tj_row_"+(c+r.rows-1)){l.opacity=0}}o.show();n===1?l.top=o.position().top-o.height()+"px":l.top=o.position().top+o.height()+"px";o.stop().animate(l,r.type.speed,r.type.easing,function(){if(parseInt(l.top)<0||parseInt(l.top)>o.height()*(r.rows-1))o.hide();++f;if(f===a){t.data("anim",false)}})});n===1?i.currentRow+=1:i.currentRow-=1;t.data("config",i)}},sequpdown:{setup:function(e,t,r){n["updown"].setup(e,t,r)},pagination:function(t,n,r){var i=t.data("config");if(n===1&&i.currentRow+r.rows>i.totalRows||n===-1&&i.currentRow-1<=0){t.data("anim",false);return false}var s=[];for(var o=0;o<=r.rows;++o){s.push(n===1?".tj_row_"+(i.currentRow+o):".tj_row_"+(i.currentRow+(o-1)))}s=s.join(",");var u=r.type.factor,a;var f=1;if(r.type.reverse)f=-1;n===f?a=t.children(s):a=t.children(s).reverse();var l=a.length,c=0;a.each(function(s){var o=e(this),a=o.attr("class"),f={},h=i.currentRow;setTimeout(function(){if(n===1){if(a==="tj_row_"+h){f.opacity=0}else if(a==="tj_row_"+(h+r.rows)){f.opacity=1}}else{if(a==="tj_row_"+(h-1)){f.opacity=1}else if(a==="tj_row_"+(h+r.rows-1)){f.opacity=0}}o.show();n===1?f.top=o.position().top-o.height()+"px":f.top=o.position().top+o.height()+"px";o.stop().animate(f,r.type.speed,r.type.easing,function(){if(parseInt(f.top)<0||parseInt(f.top)>o.height()*(r.rows-1))o.hide();++c;if(c===l){t.data("anim",false)}})},u+s*u)});n===1?i.currentRow+=1:i.currentRow-=1;t.data("config",i)}},showhide:{setup:function(t,n,r){var i=t.data("config");n.each(function(t){var s=e(this),o=Math.ceil((t+1)/i.rowCount),u,a=o%r.rows;if(a===1){u="0px"}else if(a===0){u=(r.rows-1)*n.height()+"px"}else{u=(a-1)*n.height()+"px"}s.css({top:u})})},pagination:function(e,t,n){var r=e.data("config");if(t===1&&r.currentRow+n.rows>r.totalRows||t===-1&&r.currentRow-n.rows<=0){e.data("anim",false);return false}var i=[],s=[];for(var o=0;o<n.rows;++o){i.push(".tj_row_"+(r.currentRow+o));s.push(t===1?".tj_row_"+(r.currentRow+n.rows+o):".tj_row_"+(r.currentRow-1-o))}i=i.join(","),s=s.join(",");e.children(i).hide(n.type.speed,n.type.easing);var u=e.children(s),a=u.length,f=0;u.show(n.type.speed,n.type.easing,function(){++f;if(f===a){e.data("anim",false)}});t===1?r.currentRow+=n.rows:r.currentRow-=n.rows;e.data("config",r)}},disperse:{setup:function(t,n,r){var i=t.data("config");n.each(function(t){var s=e(this),o=Math.ceil((t+1)/i.rowCount),u,a=o%r.rows;if(a===1){u="0px"}else if(a===0){u=(r.rows-1)*n.height()+"px"}else{u=(a-1)*n.height()+"px"}s.css({top:u}).data("top",u)})},pagination:function(t,n,r){var i=t.data("config");if(n===1&&i.currentRow+r.rows>i.totalRows||n===-1&&i.currentRow-r.rows<=0){t.data("anim",false);return false}var s=[],o=[];for(var u=0;u<r.rows;++u){s.push(".tj_row_"+(i.currentRow+u));o.push(n===1?".tj_row_"+(i.currentRow+r.rows+u):".tj_row_"+(i.currentRow-1-u))}s=s.join(","),o=o.join(",");t.children(s).each(function(t){var n=e(this);n.stop().animate({left:n.position().left+Math.floor(Math.random()*101)-50+"px",top:n.position().top+Math.floor(Math.random()*101)-50+"px",opacity:0},r.type.speed,r.type.easing,function(){n.css({left:n.data("left"),top:n.data("top")}).hide()})});var a=t.children(o);total_elems=a.length,cnt=0;a.each(function(n){var i=e(this);i.css({left:parseInt(i.data("left"))+Math.floor(Math.random()*301)-150+"px",top:parseInt(i.data("top"))+Math.floor(Math.random()*301)-150+"px",opacity:0}).show().animate({left:i.data("left"),top:i.data("top"),opacity:1},r.type.speed,r.type.easing,function(){++cnt;if(cnt===total_elems){t.data("anim",false)}})});n===1?i.currentRow+=r.rows:i.currentRow-=r.rows;t.data("config",i)}},rows:{setup:function(e,t,r){n["def"].setup(e,t,r)},pagination:function(t,n,r){var i=t.data("config");if(n===1&&i.currentRow+r.rows>i.totalRows||n===-1&&i.currentRow-r.rows<=0){t.data("anim",false);return false}var s=[],o=[];for(var u=0;u<r.rows;++u){s.push(".tj_row_"+(i.currentRow+u));o.push(n===1?".tj_row_"+(i.currentRow+r.rows+u):".tj_row_"+(i.currentRow-1-u))}s=s.join(","),o=o.join(",");t.children(s).each(function(t){var n=e(this),i=n.attr("class").match(/tj_row_(\d+)/)[1],s;if(i%2===0){s=r.type.factor}else{s=-r.type.factor}n.stop().animate({left:n.position().left+s+"px",opacity:0},r.type.speed,r.type.easing,function(){n.css({left:n.data("left")}).hide()})});var a=t.children(o);total_elems=a.length,cnt=0;a.each(function(n){var i=e(this),s=i.attr("class").match(/tj_row_(\d+)/)[1],o;if(s%2===0){o=r.type.factor}else{o=-r.type.factor}i.css({left:parseInt(i.data("left"))+o+"px",opacity:0}).show().animate({left:i.data("left"),opacity:1},r.type.speed,r.type.easing,function(){++cnt;if(cnt===total_elems){t.data("anim",false)}})});n===1?i.currentRow+=r.rows:i.currentRow-=r.rows;t.data("config",i)}}},r={init:function(r){if(this.length){var i={rows:2,navL:"#tj_prev",navR:"#tj_next",navDots:"#tj_dots",type:{mode:"def",speed:500,easing:"jswing",factor:50,reverse:false,timeout:3e3}};return this.each(function(){function h(){if(o.data("anim"))return false;config=o.data("config");if(config.totalRows===config.currentRow){if($backToTop===false)$backToTop=true;o.data("anim",true);n[i.type.mode].pagination(o,-1,i);return false}else if($backToTop===true){if(config.currentRow===1){$backToTop=false;o.data("anim",true);n[i.type.mode].pagination(o,1,i)}else{o.data("anim",true);n[i.type.mode].pagination(o,-1,i)}return false}else if($backToTop===false){o.data("anim",true);n[i.type.mode].pagination(o,1,i);return false}}if(r){e.extend(i,r)}var s=e(this).css("visibility","hidden"),o=s.find("ul.tj_gallery"),u=o.children("li"),a=u.length,f=e(i.navL),l=e(i.navR);$d_nav=e(i.navDots);$timeout=i.type.timeout;$backToTop=true;o.data("anim",false);var c=0;u.find("img").each(function(r){var h=e(this);e("<img/>").load(function(){++c;if(c===a){t.setup(o,u,i);s.css("visibility","visible");if(f.length){f.bind("click.gridnav",function(e){clearInterval(p);if(o.data("anim"))return false;o.data("anim",true);n[i.type.mode].pagination(o,-1,i);f.removeClass("disabled").addClass(t.has_prev(o)?"":"disabled");l.removeClass("disabled").addClass(t.has_next(o)?"":"disabled");$d_nav.find("li").removeClass("active").end().find("li:nth-child("+t.get_page(o)+")").addClass("active");return false})}if(l.length){l.bind("click.gridnav",function(e){clearInterval(p);if(o.data("anim"))return false;o.data("anim",true);n[i.type.mode].pagination(o,1,i);f.removeClass("disabled").addClass(t.has_prev(o)?"":"disabled");l.removeClass("disabled").addClass(t.has_next(o)?"":"disabled");$d_nav.find("li").removeClass("active").end().find("li:nth-child("+t.get_page(o)+")").addClass("active");return false})}s.bind("mousewheel.gridnav",function(e,r){if(r>0){if(o.data("anim"))return false;o.data("anim",true);n[i.type.mode].pagination(o,-1,i);f.removeClass("disabled").addClass(t.has_prev(o)?"":"disabled");l.removeClass("disabled").addClass(t.has_next(o)?"":"disabled");$d_nav.find("li").removeClass("active").end().find("li:nth-child("+t.get_page(o)+")").addClass("active")}else{if(o.data("anim"))return false;o.data("anim",true);n[i.type.mode].pagination(o,1,i);f.removeClass("disabled").addClass(t.has_prev(o)?"":"disabled");l.removeClass("disabled").addClass(t.has_next(o)?"":"disabled");$d_nav.find("li").removeClass("active").end().find("li:nth-child("+t.get_page(o)+")").addClass("active")}return false})}}).attr("src",h.attr("src"))});if($timeout>0){var p=setInterval(h,$timeout);o.hover(function(){clearInterval(p)},function(){p=setInterval(h,i.type.timeout)})}})}}};e.fn.gridnav=function(t){if(r[t]){return r[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return r.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.gridnav")}}})(jQuery)